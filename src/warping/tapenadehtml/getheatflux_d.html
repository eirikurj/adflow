<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="getheatflux_d"></a><a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!  Differentiation of getheatflux in forward (tangent) mode:</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!   variations   of useful results: hflux</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!   with respect to varying inputs: hflux</code></a>
<a name="p10"></a><a name="getheatflux_di0"></a><a href="getheatflux_p.html#getheatflux" target="origFile"><code class="comment">!   RW status of diff variables: hflux:in-out</code></a>
<a name="p11"></a><a name="getheatflux_di1"></a><a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">GETHEATFLUX_D</code>(<code class="vardecl">hflux</code>, <code class="vardecl">hfluxd</code>, <code class="vardecl">npts</code>, <code class="vardecl">sps</code>)</a>
<a name="p12"></a><a name="getheatflux_di2"></a>  <a href="msg.html#p10" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi0" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS</code></a>
  <a href="msg.html#p11" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi1" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code>, <code class="keyword">ONLY </code>: ndom, nbocos, bctype, bcdata</a>
<a name="p13"></a><a name="getheatflux_di3"></a>  <a href="msg.html#p12" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi2" target="origFile"><code class="keyword">USE </code><code class="funcname">SURFACEFAMILIES</code>, <code class="keyword">ONLY </code>: bcfamexchange, familyexchange, zerocellval<code class="label">&</code></a>
<a href="getheatflux_p.html#getheatfluxi2" target="origFile"><code class="label">& </code>, zeronodeval</a>
<a name="getheatflux_di4"></a>  <a href="msg.html#p13" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi3" target="origFile"><code class="keyword">USE </code><code class="funcname">UTILS</code>, <code class="keyword">ONLY </code>: setpointers</a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="getheatflux_p.html#getheatfluxi4" target="origFile"><code class="comment">!</code></a>
<a href="getheatflux_p.html#getheatfluxi4" target="origFile"><code class="comment">!      Local variables.</code></a>
<a name="getheatflux_di5"></a><a href="getheatflux_p.html#getheatfluxi4" target="origFile"><code class="comment">!</code></a>
  <a href="getheatflux_p.html#getheatfluxi4" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npts</code>, <code class="vardecl">sps</code></a>
<a name="getheatflux_di6"></a>  <a href="getheatflux_p.html#getheatfluxi5" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">hflux</code>(<code class="vardecl">npts</code>)</a>
<a name="getheatflux_di7"></a>  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(OUT) </code>:: <code class="vardecl">hfluxd</code>(<code class="vardecl">npts</code>)</a>
<a name="p67"></a><a name="getheatflux_di8"></a>  <a href="getheatflux_p.html#getheatfluxi6" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">mm</code>, <code class="vardecl">nn</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ii</code></a>
  <a href="getheatflux_p.html#getheatfluxi7" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">ibeg</code>, <code class="vardecl">iend</code>, <code class="vardecl">jbeg</code>, <code class="vardecl">jend</code></a>
<a name="getheatflux_di9"></a>  <a href="msg.html#p67" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi8" target="origFile"><code class="typename">TYPE(FAMILYEXCHANGE)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">exch</code></a>
<a name="getheatflux_di10"></a>  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">FAMILYEXCHANGE</code><code class="keyword">)</code>, <code class="modifier">POINTER </code>:: <code class="vardecl">exchd</code></a>
<a name="getheatflux_di11"></a>  <a href="getheatflux_p.html#getheatfluxi9" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCFAMEXCHANGE</code></a>
<a name="getheatflux_di12"></a>  <a href="getheatflux_p.html#getheatfluxi10" target="origFile"><code class="keyword">TYPE(</code><code class="typename">FAMILYEXCHANGE</code><code class="keyword">) </code>:: <code class="funcname">BCFAMEXCHANGE</code></a>
<a name="getheatflux_di13"></a>  <a href="getheatflux_p.html#getheatfluxi11" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">SETPOINTERS</code></a>
<a name="getheatflux_di14"></a>  <a href="getheatflux_p.html#getheatfluxi12" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCDATA</code></a>
<a name="p84"></a><a name="getheatflux_di15"></a>  <a href="getheatflux_p.html#getheatfluxi13" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCDATA</code></a>
<a name="getheatflux_di16"></a>  <a href="getheatflux_p.html#getheatfluxi14" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCTYPE</code></a>
<a name="getheatflux_di17"></a>  <a href="msg.html#p84" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi15" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCTYPE</code></a>
<a name="getheatflux_di18"></a>  <a href="getheatflux_p.html#getheatfluxi16" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">COMPUTEWEIGHTING</code></a>
<a name="getheatflux_di19"></a>  <a href="getheatflux_p.html#getheatfluxi17" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">SURFACECELLCENTERTONODE</code></a>
<a name="getheatflux_di20"></a>  <a href="getheatflux_p.html#getheatfluxi18" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result1</code></a>
<a name="getheatflux_di21"></a>  <a href="getheatflux_p.html#getheatfluxi19" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result10</code></a>
<a name="getheatflux_di22"></a>  <a href="getheatflux_p.html#getheatfluxi20" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result11</code></a>
<a name="getheatflux_di23"></a>  <a href="getheatflux_p.html#getheatfluxi21" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result2</code></a>
<a name="getheatflux_di24"></a>  <a href="getheatflux_p.html#getheatfluxi22" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result12</code></a>
<a name="getheatflux_di25"></a>  <a href="getheatflux_p.html#getheatfluxi23" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result13</code></a>
<a name="getheatflux_di26"></a>  <a href="getheatflux_p.html#getheatfluxi24" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result20</code></a>
  <a href="getheatflux_p.html#getheatfluxi25" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result14</code></a>
  <a href="getheatflux_p.html#getheatfluxi26" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result21</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nswallisothermal</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">SURFACECELLCENTERTONODE_D</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbocos</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ndom</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">eulerwall</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nswalladiabatic</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">zeronodeval</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">zerocellval</code></a>
  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">ibcgroupwalls</code></a>
<a name="getheatflux_di27"></a>  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">zero</code></a>
<a name="p68"></a><a name="getheatflux_di27"></a>  <a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">COMPUTEWEIGHTING_D</code></a>
<a name="p69"></a><a name="getheatflux_di50"></a>  <a href="getheatflux_p.html#getheatfluxi27" target="origFile">exchd =&gt; </a>
<a name="getheatflux_di28"></a>  <a href="getheatflux_p.html#getheatfluxi27" target="origFile">exch =&gt; <code class="funcname">BCFAMEXCHANGE</code>(</a><a href="msg.html#p68" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi27" target="origFile">ibcgroupwalls, sps)</a>
<a name="getheatflux_di29"></a>  <a href="getheatflux_p.html#getheatfluxi50" target="origFile"><code class="keyword">DO </code>nn=<code class="constant">1</code>,</a><a href="msg.html#p69" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi50" target="origFile">ndom</a>
<a name="p70"></a><a name="getheatflux_di49"></a>    <a href="getheatflux_p.html#getheatfluxi28" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETPOINTERS</code>(nn, <code class="constant">1_intType</code>, sps)</a>
<a name="getheatflux_di30"></a>    <a href="getheatflux_p.html#getheatfluxi29" target="origFile"><code class="keyword">CALL </code><code class="funcname">HEATFLUXES_CD</code>()</a>
<a name="getheatflux_di31"></a>    <a href="getheatflux_p.html#getheatfluxi49" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,</a><a href="msg.html#p70" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi49" target="origFile">nbocos</a>
<a name="getheatflux_di32"></a>      <a href="getheatflux_p.html#getheatfluxi30" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di33"></a>      <a href="getheatflux_p.html#getheatfluxi31" target="origFile">ibeg = result1%inbeg</a>
<a name="getheatflux_di34"></a>      <a href="getheatflux_p.html#getheatfluxi32" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di35"></a>      <a href="getheatflux_p.html#getheatfluxi33" target="origFile">iend = result1%inend</a>
<a name="getheatflux_di36"></a>      <a href="getheatflux_p.html#getheatfluxi34" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di37"></a>      <a href="getheatflux_p.html#getheatfluxi35" target="origFile">jbeg = result1%jnbeg</a>
<a name="p85"></a><a name="getheatflux_di38"></a>      <a href="getheatflux_p.html#getheatfluxi36" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="p71"></a><a name="getheatflux_di39"></a>      <a href="getheatflux_p.html#getheatfluxi37" target="origFile">jend = result1%jnend</a>
<a name="getheatflux_di40"></a>      <a href="getheatflux_p.html#getheatfluxi38" target="origFile">result10 = </a><a href="msg.html#p85" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi38" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="p72"></a><a name="getheatflux_di41"></a>      <a href="getheatflux_p.html#getheatfluxi39" target="origFile"><code class="keyword">IF</code> (result10 .EQ. </a><a href="msg.html#p71" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi39" target="origFile">nswallisothermal) <code class="keyword">THEN</code></a>
        <a href="getheatflux_p.html#getheatfluxi40" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="p86"></a><a name="getheatflux_di42"></a>        <a href="msg.html#p72" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi41" target="origFile">result1%cellval = <code class="funcname">BCDATA</code>(mm)%area(:, :)</a>
<a name="p87"></a><a name="getheatflux_di43"></a>      <a href="getheatflux_p.html#getheatfluxi39" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p74"></a><a name="p73"></a><a name="getheatflux_di44"></a>        <a href="getheatflux_p.html#getheatfluxi42" target="origFile">result11 = </a><a href="msg.html#p86" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi42" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
        <a href="getheatflux_p.html#getheatfluxi43" target="origFile">result2 = </a><a href="msg.html#p87" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi43" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="getheatflux_di45"></a>        <a href="getheatflux_p.html#getheatfluxi44" target="origFile"><code class="keyword">IF</code> (result11 .EQ. </a><a href="msg.html#p73" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi44" target="origFile">eulerwall .OR. result2 .EQ. </a><a href="msg.html#p74" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi44" target="origFile">nswalladiabatic) <code class="label">&</code></a>
<a name="p75"></a><a name="p76"></a><a name="getheatflux_di46"></a><a href="getheatflux_p.html#getheatfluxi44" target="origFile"><code class="label">&       </code><code class="keyword">THEN</code></a>
<a name="getheatflux_di47"></a>          <a href="getheatflux_p.html#getheatfluxi45" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="p77"></a><a name="p78"></a><a name="getheatflux_di48"></a>          <a href="msg.html#p76" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi46" target="origFile">result1%cellval = </a><a href="msg.html#p75" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi46" target="origFile">zerocellval</a>
          <a href="getheatflux_p.html#getheatfluxi47" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
          <a href="msg.html#p78" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi48" target="origFile">result1%nodeval = </a><a href="msg.html#p77" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi48" target="origFile">zeronodeval</a>
        <a href="getheatflux_p.html#getheatfluxi44" target="origFile"><code class="keyword">END IF</code></a>
      <a href="getheatflux_p.html#getheatfluxi39" target="origFile"><code class="keyword">END IF</code></a>
<a name="getheatflux_di51"></a>    <a href="getheatflux_p.html#getheatfluxi49" target="origFile"><code class="keyword">END DO</code></a>
<a name="p113"></a><a name="getheatflux_di60"></a>  <a href="getheatflux_p.html#getheatfluxi50" target="origFile"><code class="keyword">END DO</code></a>
<a name="getheatflux_di52"></a>  <a href="getheatflux_p.html#getheatfluxi51" target="origFile"><code class="keyword">CALL </code><code class="funcname">COMPUTEWEIGHTING_D</code>(exch)</a>
<a name="p114"></a><a name="getheatflux_di59"></a>  <a href="getheatflux_p.html#getheatfluxi60" target="origFile"><code class="keyword">DO </code>nn=<code class="constant">1</code>,</a><a href="msg.html#p113" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi60" target="origFile">ndom</a>
<a name="p88"></a><a name="getheatflux_di53"></a>    <a href="getheatflux_p.html#getheatfluxi52" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETPOINTERS</code>(nn, <code class="constant">1_intType</code>, sps)</a>
<a name="p115"></a><a name="getheatflux_di54"></a>    <a href="getheatflux_p.html#getheatfluxi59" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,</a><a href="msg.html#p114" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi59" target="origFile">nbocos</a>
<a name="getheatflux_di55"></a>      <a href="getheatflux_p.html#getheatfluxi53" target="origFile">result12 = </a><a href="msg.html#p88" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi53" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="p80"></a><a name="getheatflux_di56"></a>      <a href="getheatflux_p.html#getheatfluxi54" target="origFile"><code class="keyword">IF</code> (result12 .EQ. </a><a href="msg.html#p115" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi54" target="origFile">nswallisothermal) <code class="keyword">THEN</code></a>
<a name="getheatflux_di57"></a>        <a href="getheatflux_p.html#getheatfluxi55" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="p81"></a><a name="getheatflux_di58"></a>        <a href="msg.html#p80" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi56" target="origFile">result1%cellval = <code class="funcname">BCDATA</code>(mm)%cellheatflux(:, :)</a>
        <a href="getheatflux_p.html#getheatfluxi57" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="msg.html#p81" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi58" target="origFile">result1%nodeval = <code class="funcname">BCDATA</code>(mm)%nodeheatflux(:, :)</a>
      <a href="getheatflux_p.html#getheatfluxi54" target="origFile"><code class="keyword">END IF</code></a>
<a name="getheatflux_di61"></a>    <a href="getheatflux_p.html#getheatfluxi59" target="origFile"><code class="keyword">END DO</code></a>
<a name="getheatflux_di62"></a>  <a href="getheatflux_p.html#getheatfluxi60" target="origFile"><code class="keyword">END DO</code></a>
  <a href="getheatflux_p.html#getheatfluxi61" target="origFile"><code class="keyword">CALL </code><code class="funcname">SURFACECELLCENTERTONODE_D</code>(exch)</a>
<a name="p116"></a><a name="getheatflux_di90"></a><a href="getheatflux_p.html#getheatfluxi62" target="origFile"><code class="comment">! Now extract into the flat array:</code></a>
<a name="getheatflux_di63"></a>  <a href="getheatflux_p.html#getheatfluxi62" target="origFile">ii = <code class="constant">0</code></a>
<a name="getheatflux_di89"></a>  <a href="getheatflux_p.html#getheatfluxi90" target="origFile"><code class="keyword">DO </code>nn=<code class="constant">1</code>,</a><a href="msg.html#p116" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi90" target="origFile">ndom</a>
    <a href="getheatflux_p.html#getheatfluxi63" target="origFile"><code class="keyword">CALL </code><code class="funcname">SETPOINTERS</code>(nn, <code class="constant">1_intType</code>, sps)</a>
<a href="getheatflux_p.html#getheatfluxi89" target="origFile"><code class="comment">! Loop over the number of viscous boundary subfaces of this block.</code></a>
<a name="p117"></a><a href="getheatflux_p.html#getheatfluxi89" target="origFile"><code class="comment">! According to preprocessing/viscSubfaceInfo, visc bocos are numbered</code></a>
<a name="p89"></a><a name="getheatflux_di64"></a><a href="getheatflux_p.html#getheatfluxi89" target="origFile"><code class="comment">! before other bocos. Therefore, mm_nViscBocos == mm_nBocos</code></a>
<a name="p118"></a><a name="getheatflux_di65"></a>    <a href="getheatflux_p.html#getheatfluxi89" target="origFile"><code class="keyword">DO </code>mm=<code class="constant">1</code>,</a><a href="msg.html#p117" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi89" target="origFile">nbocos</a>
<a name="getheatflux_di66"></a>      <a href="getheatflux_p.html#getheatfluxi64" target="origFile">result13 = </a><a href="msg.html#p89" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi64" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="getheatflux_di67"></a>      <a href="getheatflux_p.html#getheatfluxi65" target="origFile"><code class="keyword">IF</code> (result13 .EQ. </a><a href="msg.html#p118" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi65" target="origFile">nswallisothermal) <code class="keyword">THEN</code></a>
<a name="getheatflux_di75"></a>        <a href="getheatflux_p.html#getheatfluxi66" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di68"></a>        <a href="getheatflux_p.html#getheatfluxi67" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di69"></a>        <a href="getheatflux_p.html#getheatfluxi75" target="origFile"><code class="keyword">DO </code>j=result1%jnbeg,result20%jnend</a>
<a name="getheatflux_di70"></a> <a href="getheatflux_p.html#getheatfluxi75" target="origFile"><code class="label">100 </code></a>     <a href="getheatflux_p.html#getheatfluxi68" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di71"></a>          <a href="getheatflux_p.html#getheatfluxi69" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di72"></a>          <a href="getheatflux_p.html#getheatfluxi70" target="origFile">i = result20%inend + <code class="constant">1</code></a>
          <a href="getheatflux_p.html#getheatfluxi71" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
          <a href="getheatflux_p.html#getheatfluxi72" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di76"></a>        <a href="getheatflux_p.html#getheatfluxi75" target="origFile"><code class="keyword">END DO</code></a>
<a name="p90"></a>      <a href="getheatflux_p.html#getheatfluxi65" target="origFile"><code class="keyword">ELSE</code></a>
<a name="p91"></a><a name="getheatflux_di77"></a><a href="getheatflux_p.html#getheatfluxi76" target="origFile"><code class="comment">! Simply put in zeros for the other wall BCs</code></a>
<a name="p120"></a><a name="p119"></a><a name="getheatflux_di78"></a>        <a href="getheatflux_p.html#getheatfluxi76" target="origFile">result14 = </a><a href="msg.html#p90" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi76" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
        <a href="getheatflux_p.html#getheatfluxi77" target="origFile">result21 = </a><a href="msg.html#p91" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi77" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="getheatflux_di79"></a>        <a href="getheatflux_p.html#getheatfluxi78" target="origFile"><code class="keyword">IF</code> (result14 .EQ. </a><a href="msg.html#p119" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi78" target="origFile">nswalladiabatic .OR. result21 .EQ. </a><a href="msg.html#p120" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getheatflux_p.html#getheatfluxi78" target="origFile">eulerwall) <code class="label">&</code></a>
<a name="getheatflux_di80"></a><a href="getheatflux_p.html#getheatfluxi78" target="origFile"><code class="label">&       </code><code class="keyword">THEN</code></a>
<a name="getheatflux_di88"></a>          <a href="getheatflux_p.html#getheatfluxi79" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di81"></a>          <a href="getheatflux_p.html#getheatfluxi80" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di82"></a>          <a href="getheatflux_p.html#getheatfluxi88" target="origFile"><code class="keyword">DO </code>j=result1%jnbeg,result20%jnend</a>
<a name="getheatflux_di83"></a> <a href="getheatflux_p.html#getheatfluxi88" target="origFile"><code class="label">110 </code></a>       <a href="getheatflux_p.html#getheatfluxi81" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di84"></a>            <a href="getheatflux_p.html#getheatfluxi82" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="getheatflux_di85"></a>            <a href="getheatflux_p.html#getheatfluxi83" target="origFile">i = result20%inend + <code class="constant">1</code></a>
            <a href="getheatflux_p.html#getheatfluxi84" target="origFile">result1 = <code class="funcname">BCDATA</code>(mm)</a>
            <a href="getheatflux_p.html#getheatfluxi85" target="origFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
          <a href="getheatflux_p.html#getheatfluxi88" target="origFile"><code class="keyword">END DO</code></a>
        <a href="getheatflux_p.html#getheatfluxi78" target="origFile"><code class="keyword">END IF</code></a>
      <a href="getheatflux_p.html#getheatfluxi65" target="origFile"><code class="keyword">END IF</code></a>
    <a href="getheatflux_p.html#getheatfluxi89" target="origFile"><code class="keyword">END DO</code></a>
  <a href="getheatflux_p.html#getheatfluxi90" target="origFile"><code class="keyword">END DO</code></a>
<a href="getheatflux_p.html#getheatflux" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">GETHEATFLUX_D</code></a>
</pre>
</body>
