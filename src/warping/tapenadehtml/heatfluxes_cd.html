<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="heatfluxes_cd"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53</code></a>
<a name="p14"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!</code></a>
<a name="p15"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">SUBROUTINE </code><code class="funcname">HEATFLUXES_CD</code>()</a>
  <a href="msg.html#p14" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS_D</code></a>
<a name="p16"></a>  <a href="msg.html#p15" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS_D</code>, <code class="keyword">ONLY </code>: bcdata, ndom, nbocos, bctype, bcfaceid, <code class="label">&</code></a>
<a name="p17"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="label">& </code>viscsubface</a>
<a name="p18"></a>  <a href="msg.html#p16" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">USE </code><code class="funcname">BCPOINTERS_D</code>, <code class="keyword">ONLY </code>: ssi</a>
  <a href="msg.html#p17" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">USE </code><code class="funcname">FLOWVARREFSTATE_D</code>, <code class="keyword">ONLY </code>: pref, rhoref</a>
  <a href="msg.html#p18" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">USE </code><code class="funcname">UTILS_D</code>, <code class="keyword">ONLY </code>: setpointers, setbcpointers</a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">IMPLICIT NONE</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!      Local variables.</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ii</code>, <code class="vardecl">mm</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">fact</code>, <code class="vardecl">scaledim</code>, <code class="vardecl">q</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">qw</code>, <code class="vardecl">qa</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">heatedsubface</code></a>
<a name="p107"></a>  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">INTRINSIC </code><code class="funcname">SQRT</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCTYPE</code></a>
  <a href="msg.html#p107" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCTYPE</code></a>
<a name="p108"></a>  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">SETBCPOINTERS</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCFACEID</code></a>
  <a href="msg.html#p108" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCFACEID</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCDATA</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE </code><code class="typename">UNKNOWNDERIVEDTYPE</code></a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL</code>, DIMENSION(:, :, :) :: <code class="vardecl">q</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END TYPE </code>UNKNOWNDERIVEDTYPE</a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCDATA</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">SSI</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="funcname">SSI</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">EXTERNAL </code><code class="funcname">VISCSUBFACE</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="funcname">VISCSUBFACE</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">arg1</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">result1</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result10</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result11</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result12</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result2</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">result20</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">result3</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">result4</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">rhoref</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nswallisothermal</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">one</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">REAL </code>:: <code class="vardecl">pref</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">imin</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbocos</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">jmin</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">kmin</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">imax</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">jmax</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">kmax</code></a>
<a name="p93"></a><a name="p111"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! Set the actual scaling factor such that ACTUAL heat flux is computed</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! The factor is determined from stanton number</code></a>
<a name="p92"></a>  <a href="heatfluxes_p.html#heatfluxes" target="origFile">arg1 = </a><a href="msg.html#p111" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">pref/</a><a href="msg.html#p93" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">rhoref</a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile">result1 = <code class="funcname">SQRT</code>(arg1)</a>
<a name="p94"></a>  <a href="heatfluxes_p.html#heatfluxes" target="origFile">scaledim = </a><a href="msg.html#p92" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">pref*result1</a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! Loop over the boundary subfaces of this block.</code></a>
<a name="p109"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="label">bocos:</code><code class="keyword">DO </code>mm=<code class="constant">1</code>,</a><a href="msg.html#p94" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">nbocos</a>
<a name="p95"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! Only do this on isoThermalWalls</code></a>
    <a href="heatfluxes_p.html#heatfluxes" target="origFile">result10 = </a><a href="msg.html#p109" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="funcname">BCTYPE</code>(mm)</a>
    <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">IF</code> (result10 .EQ. </a><a href="msg.html#p95" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">nswallisothermal) <code class="keyword">THEN</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! Set a bunch of pointers depending on the face id to make</code></a>
<a name="p96"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! a generic treatment possible. The routine setBcPointers</code></a>
<a name="p97"></a><a name="p110"></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! is not used, because quite a few other ones are needed.</code></a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">CALL </code></a><a href="msg.html#p96" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="funcname">SETBCPOINTERS</code>(mm, <code class="constant">.true.</code>)</a>
<a name="p100"></a><a name="p99"></a><a name="p98"></a>      <a href="heatfluxes_p.html#heatfluxes" target="origFile">result11 = </a><a href="msg.html#p110" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="msg.html#p97" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="funcname">BCFACEID</code>(mm)</a>
<a name="p104"></a>      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">SELECT CASE </code> (result11) </a>
<a name="p103"></a><a name="p102"></a><a name="p101"></a>      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">CASE </code>(</a><a href="msg.html#p98" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">imin, </a><a href="msg.html#p99" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">jmin, </a><a href="msg.html#p100" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">kmin) </a>
<a name="p112"></a>        <a href="heatfluxes_p.html#heatfluxes" target="origFile">fact = -</a><a href="msg.html#p104" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">one</a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">CASE </code>(</a><a href="msg.html#p101" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">imax, </a><a href="msg.html#p102" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">jmax, </a><a href="msg.html#p103" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">kmax) </a>
        <a href="heatfluxes_p.html#heatfluxes" target="origFile">fact = </a><a href="msg.html#p112" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="heatfluxes_p.html#heatfluxes" target="origFile">one</a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END SELECT</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! Loop over the quadrilateral faces of the subface. Note that</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! the nodal range of BCData must be used and not the cell</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! range, because the latter may include the halo's in i and</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! j-direction. The offset +1 is there, because inBeg and jnBeg</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">! refer to nodal ranges and not to cell ranges.</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="comment">!</code></a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile">result12 = <code class="funcname">BCDATA</code>(mm)</a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile">result2 = <code class="funcname">BCDATA</code>(mm)</a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">DO </code>j=result12%jnbeg+<code class="constant">1</code>,result2%jnend</a>
 <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="label">100    </code>result12 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="heatfluxes_p.html#heatfluxes" target="origFile">result2 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="heatfluxes_p.html#heatfluxes" target="origFile">i = result2%inend + <code class="constant">1</code></a>
        <a href="heatfluxes_p.html#heatfluxes" target="origFile">result12 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="heatfluxes_p.html#heatfluxes" target="origFile">result2 = <code class="funcname">BCDATA</code>(mm)</a>
      <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END DO</code></a>
    <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END IF</code></a>
  <a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
<a href="heatfluxes_p.html#heatfluxes" target="origFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">HEATFLUXES_CD</code></a>
</pre>
</body>
