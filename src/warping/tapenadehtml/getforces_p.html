<title>Generated by TAPENADE</title>
<link type="text/CSS" rel="stylesheet" href="tapenade.css">
<link type="text/CSS" rel="stylesheet" href="fortranStyle.css">
<body>
<pre><a name="getforces"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">!        Generated by TAPENADE     (INRIA, Tropics team)</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">!  Tapenade 3.10 (r5363) -  9 Sep 2014 09:53</code></a>
<a name="p0"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">!</code></a>
<a name="p1"></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">SUBROUTINE </code><code class="funcname">GETFORCES</code>(<code class="vardecl">forces</code>, <code class="vardecl">npts</code>, <code class="vardecl">sps</code>)</a>
<a name="p2"></a>  <a href="msg.html#p0" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">CONSTANTS</code></a>
<a name="p3"></a>  <a href="msg.html#p1" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">COMMUNICATION</code>, <code class="keyword">ONLY </code>: myid</a>
<a name="p4"></a>  <a href="msg.html#p2" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">BLOCKPOINTERS</code>, <code class="keyword">ONLY </code>: bcdata, ndom, nbocos, bctype</a>
<a name="p5"></a>  <a href="msg.html#p3" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">INPUTPHYSICS</code>, <code class="keyword">ONLY </code>: forcesastractions</a>
<a name="p6"></a>  <a href="msg.html#p4" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">UTILS</code>, <code class="keyword">ONLY </code>: setpointers, terminate, echk</a>
<a name="p7"></a>  <a href="msg.html#p5" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">SURFACEINTEGRATIONS</code>, <code class="keyword">ONLY </code>: integratesurfaces</a>
<a name="p8"></a>  <a href="msg.html#p6" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">SURFACEFAMILIES</code>, <code class="keyword">ONLY </code>: fullfamlist</a>
<a name="p9"></a>  <a href="msg.html#p7" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">OVERSETDATA</code>, <code class="keyword">ONLY </code>: zippermeshes, zippermesh, oversetpresent</a>
  <a href="msg.html#p8" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">SURFACEFAMILIES</code>, <code class="keyword">ONLY </code>: familyexchange, bcfamexchange</a>
  <a href="msg.html#p9" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">USE </code><code class="funcname">PETSC</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IMPLICIT NONE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">)</code>, <code class="typename">INTENT(IN) </code>:: <code class="vardecl">npts</code>, <code class="vardecl">sps</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">INTENT(INOUT) </code>:: <code class="vardecl">forces</code>(<code class="constant">3</code>, <code class="vardecl">npts</code>)</a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">mm</code>, <code class="vardecl">nn</code>, <code class="vardecl">i</code>, <code class="vardecl">j</code>, <code class="vardecl">ii</code>, <code class="vardecl">jj</code>, <code class="vardecl">idim</code>, <code class="vardecl">ierr</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER(</code><code class="keyword">kind</code>=<code class="modifier">inttype</code><code class="typename">) </code>:: <code class="vardecl">ibeg</code>, <code class="vardecl">iend</code>, <code class="vardecl">jbeg</code>, <code class="vardecl">jend</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sss</code>(<code class="constant">3</code>), <code class="vardecl">v2</code>(<code class="constant">3</code>), <code class="vardecl">v1</code>(<code class="constant">3</code>), <code class="vardecl">qa</code>, <code class="vardecl">sepsensor</code>, <code class="vardecl">cavitation</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">sepsensoravg</code>(<code class="constant">3</code>)</a>
<a name="p19"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">fp</code>(<code class="constant">3</code>), <code class="vardecl">fv</code>(<code class="constant">3</code>), <code class="vardecl">mp</code>(<code class="constant">3</code>), <code class="vardecl">mv</code>(<code class="constant">3</code>), <code class="vardecl">yplusmax</code>, <code class="vardecl">qf</code>(<code class="constant">3</code>)</a>
<a name="p21"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nlocalvalues</code></a>
<a name="p22"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">) </code>:: <code class="vardecl">localvalues</code>(</a><a href="msg.html#p19" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="vardecl">nlocalvalues</code>)</a>
  <a href="msg.html#p21" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="typename">TYPE(ZIPPERMESH)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">zipper</code></a>
  <a href="msg.html#p22" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="typename">TYPE(FAMILYEXCHANGE)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">exch</code></a>
<a name="p20"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code>:<code class="typename">)</code>, <code class="typename">POINTER </code>:: <code class="vardecl">localptr</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">ncostfunction</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL(</code><code class="keyword">kind</code>=<code class="modifier">realtype</code><code class="typename">)</code>, <code class="typename">DIMENSION(</code></a><a href="msg.html#p20" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">ncostfunction<code class="typename">) </code>:: <code class="vardecl">funcvalues</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">SETPOINTERS</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">INTEGRATESURFACES</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">COMPUTENODALTRACTIONS</code></a>
<a name="p63"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">COMPUTENODALFORCES</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCTYPE</code></a>
  <a href="msg.html#p63" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCTYPE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCDATA</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE </code><code class="typename">UNKNOWNDERIVEDTYPE</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">jnbeg</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">jnend</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">inbeg</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">inend</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :, :) :: <code class="vardecl">tp</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :, :) :: <code class="vardecl">tv</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :, :) :: <code class="vardecl">f</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">)</code>, DIMENSION(:) :: <code class="vardecl">cellval</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">)</code>, DIMENSION(:, :) :: <code class="vardecl">area</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">)</code>, DIMENSION(:) :: <code class="vardecl">nodeval</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :) :: <code class="vardecl">cellheatflux</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :) :: <code class="vardecl">nodeheatflux</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL</code>, DIMENSION(:, :, :) :: <code class="vardecl">norm</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END TYPE </code>UNKNOWNDERIVEDTYPE</a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="funcname">BCDATA</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">ZIPPERMESHES</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">ZIPPERMESH</code><code class="keyword">) </code>:: <code class="funcname">ZIPPERMESHES</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">BCFAMEXCHANGE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">FAMILYEXCHANGE</code><code class="keyword">) </code>:: <code class="funcname">BCFAMEXCHANGE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">TERMINATE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">VECGETARRAYF90</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">ECHK</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">INTRINSIC </code><code class="funcname">SIZE</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">VECRESTOREARRAYF90</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">VECSCATTERBEGIN</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">EXTERNAL </code><code class="funcname">VECSCATTEREND</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result1</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result2</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result3</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result10</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNDERIVEDTYPE</code><code class="keyword">) </code>:: <code class="vardecl">result20</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">__file__</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nswallisothermal</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">__line__</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">fullfamlist</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">nbocos</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">ndom</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">insert_values</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">INTEGER </code>:: <code class="vardecl">myid</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">eulerwall</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">nswalladiabatic</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">ibcgroupwalls</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">forcesastractions</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">TYPE(</code><code class="typename">UNKNOWNTYPE</code><code class="keyword">) </code>:: <code class="vardecl">scatter_forward</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">REAL </code>:: <code class="vardecl">zero</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="typename">LOGICAL </code>:: <code class="vardecl">oversetpresent</code></a>
<a name="p23"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! Make sure *all* forces are computed. Sectioning will be done</code></a>
<a name="p24"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! else-where.</code></a>
<a name="p25"></a><a href="getforces.html#getforces" target="diffFile"><code class="label">domains:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,</a><a href="msg.html#p23" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">ndom</a>
<a name="p26"></a><a name="p27"></a>    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p24" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">SETPOINTERS</code>(nn, <code class="constant">1_intType</code>, sps)</a>
    <a href="getforces.html#getforces" target="diffFile">localvalues = </a><a href="msg.html#p25" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">zero</a>
<a name="p28"></a>    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p27" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">INTEGRATESURFACES</code>(localvalues, </a><a href="msg.html#p26" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">fullfamlist)</a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END DO </code><code class="label">domains</code></a>
<a name="p29"></a>  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p28" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">forcesastractions) <code class="keyword">THEN</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! Compute tractions if necessary</code></a>
<a name="p30"></a>    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p29" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">COMPUTENODALTRACTIONS</code>(sps)</a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">ELSE</code></a>
    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p30" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">COMPUTENODALFORCES</code>(sps)</a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END IF</code></a>
  <a href="getforces.html#getforces" target="diffFile">ii = <code class="constant">0</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="label">domains2:</code><code class="keyword">DO </code>nn=<code class="constant">1</code>,ndom</a>
<a name="p31"></a>    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">SETPOINTERS</code>(nn, <code class="constant">1_intType</code>, sps)</a>
<a name="p32"></a><a name="p64"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! Loop over the number of boundary subfaces of this block.</code></a>
<a name="p65"></a><a href="getforces.html#getforces" target="diffFile"><code class="label">bocos:</code><code class="keyword">DO </code>mm=<code class="constant">1</code>,</a><a href="msg.html#p31" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">nbocos</a>
<a name="p66"></a>      <a href="getforces.html#getforces" target="diffFile">result1 = </a><a href="msg.html#p64" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="msg.html#p32" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="p34"></a><a name="p33"></a>      <a href="getforces.html#getforces" target="diffFile">result2 = </a><a href="msg.html#p65" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCTYPE</code>(mm)</a>
<a name="p35"></a>      <a href="getforces.html#getforces" target="diffFile">result3 = </a><a href="msg.html#p66" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCTYPE</code>(mm)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IF</code> ((result1 .EQ. </a><a href="msg.html#p33" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">eulerwall .OR. result2 .EQ. </a><a href="msg.html#p34" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">nswalladiabatic) <code class="label">&</code></a>
<a name="p36"></a><a href="getforces.html#getforces" target="diffFile"><code class="label">&         </code>.OR. result3 .EQ. </a><a href="msg.html#p35" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">nswallisothermal) <code class="keyword">THEN</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! This is easy, just copy out F or T in continuous ordering.</code></a>
        <a href="getforces.html#getforces" target="diffFile">result10 = </a><a href="msg.html#p36" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCDATA</code>(mm)</a>
        <a href="getforces.html#getforces" target="diffFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="getforces.html#getforces" target="diffFile"><code class="keyword">DO </code>j=result10%jnbeg,result20%jnend</a>
 <a href="getforces.html#getforces" target="diffFile"><code class="label">100      </code>result10 = <code class="funcname">BCDATA</code>(mm)</a>
<a name="p36"></a>          <a href="getforces.html#getforces" target="diffFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
          <a href="getforces.html#getforces" target="diffFile">i = result20%inend + <code class="constant">1</code></a>
          <a href="getforces.html#getforces" target="diffFile">result10 = </a><a href="msg.html#p36" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCDATA</code>(mm)</a>
          <a href="getforces.html#getforces" target="diffFile">result20 = <code class="funcname">BCDATA</code>(mm)</a>
        <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END DO</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END IF</code></a>
    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END DO </code><code class="label">bocos</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END DO </code><code class="label">domains2</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! We know must consider additional forces that are required by the</code></a>
<a name="p37"></a><a name="p38"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! zipper mesh triangles on the root proc.</code></a>
<a name="p39"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! Pointer for easier reading.</code></a>
  <a href="getforces.html#getforces" target="diffFile">zipper =&gt; </a><a href="msg.html#p38" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">ZIPPERMESHES</code>(</a><a href="msg.html#p37" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">ibcgroupwalls)</a>
<a name="p40"></a>  <a href="getforces.html#getforces" target="diffFile">exch =&gt; </a><a href="msg.html#p39" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">BCFAMEXCHANGE</code>(ibcgroupwalls, sps)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! No overset present or the zipper isn't allocated nothing to do:</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IF</code> ((.NOT.</a><a href="msg.html#p40" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">oversetpresent) .OR. (.NOT.zipper%allocated)) <code class="keyword">THEN</code></a>
<a name="p42"></a>    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">RETURN</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">ELSE</code></a>
    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IF</code> (.NOT.forcesastractions) <code class="keyword">CALL </code></a><a href="msg.html#p42" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">TERMINATE</code>(<code class="string">'getForces'</code>, <code class="label">&</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="label">&                 </code><code class="string">'getForces() is not implmented for zipper meshes and '</code><code class="label">&</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="label">&                                        </code>, <code class="string">'forcesAsTractions=False'</code>)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! We have a zipper and regular forces are requested. This is not yet supported.</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! Loop over each dimension individually since we have a scalar</code></a>
<a name="p44"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! scatter.</code></a>
<a name="p46"></a><a name="p45"></a><a name="p47"></a><a href="getforces.html#getforces" target="diffFile"><code class="label">dimloop:</code><code class="keyword">DO </code>idim=<code class="constant">1</code>,<code class="constant">3</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p44" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">VECGETARRAYF90</code>(exch%nodevallocal, localptr, ierr)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p47" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">ECHK</code>(ierr, </a><a href="msg.html#p45" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">__file__, </a><a href="msg.html#p46" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">__line__)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! Copy in the values we already have to the exchange.</code></a>
      <a href="getforces.html#getforces" target="diffFile">ii = <code class="funcname">SIZE</code>(localptr)</a>
<a name="p49"></a>      <a href="getforces.html#getforces" target="diffFile">localptr = forces(idim, <code class="constant">1</code>:ii)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! Restore the pointer</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p49" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">VECRESTOREARRAYF90</code>(exch%nodevallocal, localptr, ierr)</a>
<a name="p55"></a>      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ECHK</code>(ierr, __file__, __line__)</a>
<a name="p54"></a><a name="p53"></a><a href="getforces.html#getforces" target="diffFile"><code class="comment">! Now scatter this to the zipper</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p55" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">VECSCATTERBEGIN</code>(zipper%scatter, exch%nodevallocal, zipper%<code class="label">&</code></a>
<a name="p59"></a><a href="getforces.html#getforces" target="diffFile"><code class="label">&                    </code>localval, </a><a href="msg.html#p53" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">insert_values, </a><a href="msg.html#p54" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">scatter_forward, ierr)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ECHK</code>(ierr, __file__, __line__)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code></a><a href="msg.html#p59" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile"><code class="funcname">VECSCATTEREND</code>(zipper%scatter, exch%nodevallocal, zipper%<code class="label">&</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="label">&                  </code>localval, insert_values, scatter_forward, ierr)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ECHK</code>(ierr, __file__, __line__)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! The values we need are precisely what is in zipper%localVal</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">VECGETARRAYF90</code>(zipper%localval, localptr, ierr)</a>
<a name="p61"></a>      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ECHK</code>(ierr, __file__, __line__)</a>
<a href="getforces.html#getforces" target="diffFile"><code class="comment">! Just copy the received data into the forces array. Just on root proc:</code></a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">IF</code> (</a><a href="msg.html#p61" target="msg"><code class="comment"><img src="danger.gif" align=middle border=0 alt="!" /></code></a><a href="getforces.html#getforces" target="diffFile">myid .EQ. <code class="constant">0</code>) forces(idim, ii+<code class="constant">1</code>:ii+<code class="funcname">SIZE</code>(localptr)) = localptr</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">VECGETARRAYF90</code>(zipper%localval, localptr, ierr)</a>
      <a href="getforces.html#getforces" target="diffFile"><code class="keyword">CALL </code><code class="funcname">ECHK</code>(ierr, __file__, __line__)</a>
    <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END DO </code><code class="label">dimloop</code></a>
  <a href="getforces.html#getforces" target="diffFile"><code class="keyword">END IF</code></a>
<a href="getforces.html#getforces" target="diffFile"><code class="keyword">END SUBROUTINE </code><code class="funcname">GETFORCES</code></a>
</pre>
</body>
